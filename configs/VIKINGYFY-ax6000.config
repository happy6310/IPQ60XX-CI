# ============================================
# ImmortalWrt for 小米AX6000 (MT7986) - 小分区精简版
# 注意：总闪存约128MB，大分区约122.5MB，本配置将根分区设为108MB
# ============================================

# ==================== 【1. 目标设备】 ====================
CONFIG_TARGET_mediatek=y
CONFIG_TARGET_mediatek_filogic=y
CONFIG_TARGET_DEVICE_mediatek_filogic_DEVICE_xiaomi_redmi-router-ax6000=y


# ==================== 【2. 镜像与分区设置 (关键)】 ====================
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_IMAGES_GZIP=y
# 分区大小：严格控制以适配122.5MB大分区，为uboot等预留约14.5MB
CONFIG_TARGET_ROOTFS_PARTSIZE=108
CONFIG_TARGET_KERNEL_PARTSIZE=16
CONFIG_TARGET_PER_DEVICE_ROOTFS=y
CONFIG_TARGET_ROOTFS_INITRAMFS=n


# ==================== 【3. 编译优化】 ====================
CONFIG_DEVEL=y
CONFIG_CCACHE=y
# CONFIG_BUILD_LOG=y  # 调试时可开启，会略微增加开销



# ==================== 【4. 内核与MT7986核心驱动】 ====================
# 4.1 CPU调度
CONFIG_PACKAGE_kmod-cpufreq=y
CONFIG_PACKAGE_kmod-cpufreq-schedutil=y
# 4.2 MTK硬件加速 (核心，必须启用)
CONFIG_PACKAGE_kmod-mt7986-firmware=y
CONFIG_PACKAGE_kmod-mtk-hwnat=y
CONFIG_PACKAGE_kmod-mtk-ppe=y
# 4.3 Wi-Fi驱动
CONFIG_PACKAGE_kmod-mt7915e=y
CONFIG_PACKAGE_kmod-mt7916-firmware=y
CONFIG_PACKAGE_kmod-mt7976-firmware=y
CONFIG_PACKAGE_wpad-openssl=y
CONFIG_PACKAGE_hostapd-common=y




# ==================== 【5. 主路由网络核心功能】 ====================
# 5.1 防火墙与转发
CONFIG_PACKAGE_iptables-mod-fullconenat=y
CONFIG_PACKAGE_ipset=y
# 5.2 动态DNS (如需)
# CONFIG_PACKAGE_luci-app-ddns=y
# 5.3 DHCP & DNS
CONFIG_PACKAGE_dnsmasq-full=y
CONFIG_PACKAGE_dnsmasq_full_ipset=y
# 建议禁用 turboacc 以节省空间
CONFIG_PACKAGE_luci-app-turboacc=y


# ==================== 【6. 科学上网与网络增强 (按需精选)】 ====================
CONFIG_PACKAGE_luci-app-openclash=y
# CONFIG_PACKAGE_luci-app-passwall2=y  # 与OpenClash二选一，体积较大
CONFIG_PACKAGE_luci-app-turboacc_INCLUDE_FLOW_OFFLOADING=y
CONFIG_PACKAGE_luci-app-turboacc_INCLUDE_SHORTCUT_FE=y

# ==================== 【WireGuard VPN】 ====================
CONFIG_PACKAGE_kmod-wireguard=y
CONFIG_PACKAGE_wireguard-tools=y
CONFIG_PACKAGE_luci-app-wireguard=y

# ==================== 【7. 系统管理与界面】 ====================
CONFIG_PACKAGE_luci=y
CONFIG_LUCI_LANG_zh_Hans=y
CONFIG_PACKAGE_default-settings=y
CONFIG_PACKAGE_luci-theme-argon=y
# Argon主题设置 (约0.5MB) # 建议禁用主题配置以节省空间
CONFIG_PACKAGE_luci-app-argon-config=n  # 主题设置，可选
# 网页终端 (约1-2MB)
CONFIG_PACKAGE_luci-app-ttyd=n
# 文件上传 (约0.5MB)
CONFIG_PACKAGE_luci-app-filetransfer=n

# ==================== 【8. 监控与诊断】 ====================
CONFIG_PACKAGE_htop=y
CONFIG_PACKAGE_ethtool=y
# 监控图表，体积较大
CONFIG_PACKAGE_luci-app-statistics=n


# ==================== 【9. 已删除/禁用的非核心大型插件】 ====================
# 以下插件体积较大，在小分区上建议禁用，用“=n”或直接删除行
# Docker相关 (完全移除)
# CONFIG_PACKAGE_docker-ce
# CONFIG_PACKAGE_luci-app-dockerman
# 文件共享 (完全移除)
# CONFIG_PACKAGE_luci-app-samba4
# CONFIG_PACKAGE_luci-app-alist
# 高级DNS广告过滤 (体积大，可选)
CONFIG_PACKAGE_luci-app-adguardhome=n
CONFIG_PACKAGE_luci-app-smartdns=n

# 其他大型插件
CONFIG_PACKAGE_luci-app-diskman=n
# ==================== 【10. 固件优化】 ====================
# 使用LZMA压缩，平衡压缩率与解压速度，兼容性最好
CONFIG_SQUASHFS_LZMA=y
CONFIG_KERNEL_LZMA=y


